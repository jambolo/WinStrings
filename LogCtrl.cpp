/****************************************************************************

                                 LogCtrl.cpp

						Copyright 2000, John J. Bolton
	----------------------------------------------------------------------

	$Header: //depot/WinStrings/LogCtrl.cpp#2 $

	$NoKeywords: $

****************************************************************************/

#include "stdafx.h"

#include "LogCtrl.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#undef THIS_FILE
static char THIS_FILE[] = __FILE__;
#endif


/********************************************************************************************************************/
/*																													*/
/*																													*/
/********************************************************************************************************************/

LogCtrl::LogCtrl()
{
}


/********************************************************************************************************************/
/*																													*/
/*																													*/
/********************************************************************************************************************/

LogCtrl::~LogCtrl()
{
}


/********************************************************************************************************************/
/*																													*/
/*																													*/
/********************************************************************************************************************/

BEGIN_MESSAGE_MAP( LogCtrl, CRichEditCtrl )
	//{{AFX_MSG_MAP(LogCtrl)
		// NOTE - the ClassWizard will add and remove mapping macros here.
	//}}AFX_MSG_MAP
END_MESSAGE_MAP()


/********************************************************************************************************************/
/*																													*/
/*																													*/
/********************************************************************************************************************/

void LogCtrl::ClearAll()
{
	SetWindowText( "" );
}


/********************************************************************************************************************/
/*																													*/
/*																													*/
/********************************************************************************************************************/

void LogCtrl::Append( LPCTSTR text, DWORD effect, COLORREF color )
{
	// Set the format

	CHARFORMAT cf = { sizeof( CHARFORMAT ), CFM_UNDERLINE|CFM_BOLD|CFM_ITALIC|CFM_COLOR };
	cf.dwEffects = effect;
	if ( color == -1 )
		cf.dwEffects |= CFE_AUTOCOLOR;
	cf.crTextColor = color;
	SetSelectionCharFormat( cf );

	// Append the text

	int const end = GetWindowTextLength();
	SetSel( end, end );
	ReplaceSel( text );
}

/********************************************************************************************************************/
/*																													*/
/*																													*/
/********************************************************************************************************************/

void LogCtrl::AppendLine( LPCTSTR text, DWORD effect, COLORREF color )
{
	// Append the text

	Append( text, effect, color );

	// Append the CRLF

	int const end2 = GetWindowTextLength();
	SetSel( end2, end2 );
	ReplaceSel( "\r\n" );
}
